<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Attendance Sheet</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    :root {
      --main-bg: linear-gradient(135deg, #230fd3, #764ba2);
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f7f9fc;
      color: #333;
      transition: background 0.3s, color 0.3s;
      animation: fadeInBody 1.2s ease;
    }

    body.dark {
      background: #1e1e2f;
      color: #f0f0f0;
    }

    @keyframes fadeInBody {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideZoom {
      0% { opacity: 0; transform: scale(0.96) translateY(20px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }

    .container {
      max-width: 960px;
      margin: auto;
      padding: 20px;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      font-weight: 700;
      color: #0715db;
      letter-spacing: 1px;
      margin-top: 40px;
      animation: slideZoom 1s ease-out;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.1);
    }

    form, .controls, #employeeTables {
      background: white;
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      animation: slideZoom 1s ease-in-out;
    }

    body.dark form, body.dark .controls, body.dark #employeeTables {
      background: #2d2d40;
    }

    input, button, select {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    button {
      background: var(--main-bg);
      color: white;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    button:hover {
      transform: scale(1.04);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: center;
    }

    th {
      background-color: #f0f0f0;
    }

    body.dark th, body.dark td {
      background-color: #333;
      color: #f0f0f0;
    }

    tr.holiday-row {
      background-color: #fff7c2;
    }

    .dark-mode-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #333;
      color: rgb(94, 91, 91);
      border: none;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: background-color 0.3s, transform 0.2s;
      z-index: 999;
    }

    body.dark .dark-mode-toggle {
      background-color: #f0f0f0;
      color: #1e1e2f;
    }

    .dark-mode-toggle:hover {
      transform: scale(1.15);
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 2rem;
      }

      .container {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Attendance Sheet</h1>

    <button class="dark-mode-toggle" onclick="toggleDarkMode()">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
      </svg>
    </button>

    <form id="attendanceForm">
      <input type="text" id="company" placeholder="Company Name" required />
      <input type="text" id="name" placeholder="Employee Name" required />
      <label><strong>Select Month:</strong></label>
      <select id="monthSelect"></select>
      <label><strong>Select Year:</strong></label>
      <select id="yearSelect"></select>
      <label><strong>Select Date:</strong></label>
      <input type="date" id="date" />
      <label><strong>In Times:</strong></label>
      <input type="time" id="inTime" required />
      <label><strong>Out Times:</strong></label>
      <input type="time" id="outTime" required />
      <button type="submit">Add / Update</button>
    </form>

    <div class="controls">
      <input type="text" id="search" placeholder="üîç Search Employee Name" />
      <button onclick="downloadExcel()">‚¨áÔ∏è Excel</button>
      <button onclick="downloadPDF()">üßæ PDF</button>
      <button onclick="clearData()"> Clear All</button>
    </div>

    <div id="employeeTables"></div>
  </div>

  <script>
    const form = document.getElementById('attendanceForm');
    const nameInput = document.getElementById('name');
    const companyInput = document.getElementById('company');
    const dateInput = document.getElementById('date');
    const inTimeInput = document.getElementById('inTime');
    const outTimeInput = document.getElementById('outTime');
    const monthSelect = document.getElementById('monthSelect');
    const yearSelect = document.getElementById('yearSelect');
    const employeeTables = document.getElementById('employeeTables');
    const searchInput = document.getElementById('search');
    const officeStart = '09:45';
    let employeeData = {};

    window.onload = () => {
      form.reset();
      loadFromStorage();
    };

    monthSelect.add(new Option("--Select Month--", "", true, true));
    for (let m = 0; m < 12; m++) {
      const opt = new Option(new Date(0, m).toLocaleString('default', { month: 'long' }), m);
      monthSelect.add(opt);
    }

    yearSelect.add(new Option("--Select Year--", "", true, true));
    const currentYear = new Date().getFullYear();
    for (let y = 2000; y <= currentYear + 50; y++) {
      const opt = new Option(y, y);
      yearSelect.add(opt);
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }
  </script>
</body>
</html>
